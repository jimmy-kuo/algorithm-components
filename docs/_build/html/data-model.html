
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Data Model &#8212; Algorithm Components  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Configurations" href="config.html" />
    <link rel="prev" title="User Manual" href="user-manual.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="data-model">
<span id="id1"></span><h1>Data Model<a class="headerlink" href="#data-model" title="Permalink to this headline">¶</a></h1>
<p>As a very typical kind of applications we can apply our pipelines of complex transforms in either computational
advertising scenario or recommendation system scenario.</p>
<p>In these domain applications the data is composed of a user
with his/her real time context followed by a list of candidate advertises. Usually the number of candidate advertises
varies from hundreds to thousands depending on system’s computational capability and ability of upper recall systems.</p>
<img alt="_images/auc-type.png" src="_images/auc-type.png" />
<p>Due to the frequency usages in above mentioned application scenarios and the consideration of implementation
efficiency, we define our data model in this way.</p>
<p>In our designed system the data has 3 statuses: attribute data, feature data and encoded data. Here is the definition
of attribute data with some commonly used types (e.g., categorical, set categorical, real valued and time).</p>
<div class="highlight-Java notranslate"><div class="highlight"><pre><span></span><span class="n">message</span> <span class="n">AUCImprAttrs</span> <span class="o">{</span>
    <span class="n">repeated</span> <span class="kt">float</span> <span class="n">labels</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="n">AttributeBunch</span> <span class="n">user_and_ctx</span> <span class="o">=</span> <span class="mi">4</span><span class="o">;</span>
    <span class="n">repeated</span> <span class="n">AttributeBunch</span> <span class="n">ads</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">message</span> <span class="n">AttributeBunch</span> <span class="o">{</span>
    <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="o">,</span> <span class="n">AttributeData</span><span class="o">&gt;</span> <span class="n">attrs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">message</span> <span class="n">AttributeData</span> <span class="o">{</span>

<span class="kd">enum</span> <span class="n">AttributeType</span> <span class="o">{</span>
    <span class="n">UNKNOWN</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">CATEGORICAL</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="c1">// string, int_val</span>
    <span class="n">SET_CATEGORICAL</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span> <span class="c1">// SetCateValue --&gt; [&lt;string, float&gt;]</span>
    <span class="n">REAL_VALUED</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span> <span class="c1">// float</span>
    <span class="n">UNIX_TIMESTAMP</span> <span class="o">=</span> <span class="mi">4</span><span class="o">;</span> <span class="c1">// int_val (1546235518)</span>
<span class="o">}</span>

<span class="n">AttributeType</span> <span class="n">attr_type</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

<span class="n">oneof</span> <span class="n">oneof_attr_val</span> <span class="o">{</span>
    <span class="n">string</span> <span class="n">str_val</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="n">int32</span> <span class="n">int_val</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
    <span class="n">int64</span> <span class="n">long_val</span> <span class="o">=</span> <span class="mi">4</span><span class="o">;</span>
    <span class="kt">float</span> <span class="n">float_val</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
    <span class="n">SetCateValue</span> <span class="n">scate_val</span> <span class="o">=</span> <span class="mi">6</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">message</span> <span class="n">SetCateValue</span> <span class="o">{</span>
    <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="o">,</span> <span class="kt">float</span><span class="o">&gt;</span> <span class="n">vals</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>And the following is the definition of feature data with discrete type and continuous type.</p>
<div class="highlight-Java notranslate"><div class="highlight"><pre><span></span><span class="n">message</span> <span class="n">AUCImprFeats</span> <span class="o">{</span>
    <span class="n">repeated</span> <span class="kt">float</span> <span class="n">labels</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="n">FeatureBunch</span> <span class="n">user_and_ctx</span> <span class="o">=</span> <span class="mi">4</span><span class="o">;</span>
    <span class="n">repeated</span> <span class="n">FeatureBunch</span> <span class="n">ads</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">message</span> <span class="n">FeatureBunch</span> <span class="o">{</span>
    <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="o">,</span> <span class="n">DiscFeatGrp</span><span class="o">&gt;</span> <span class="n">disc_feats</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="o">,</span> <span class="n">ContFeatGrp</span><span class="o">&gt;</span> <span class="n">cont_feats</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">message</span> <span class="n">DiscFeatGrp</span> <span class="o">{</span>
    <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="o">,</span> <span class="n">DiscFeatData</span><span class="o">&gt;</span> <span class="n">feats</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">message</span> <span class="n">ContFeatGrp</span> <span class="o">{</span>
    <span class="n">map</span><span class="o">&lt;</span><span class="n">string</span><span class="o">,</span> <span class="n">ContFeatData</span><span class="o">&gt;</span> <span class="n">feats</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">message</span> <span class="n">DiscFeatData</span> <span class="o">{</span>
    <span class="n">string</span> <span class="n">gname</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="n">string</span> <span class="n">fname</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">message</span> <span class="n">ContFeatData</span> <span class="o">{</span>
    <span class="n">string</span> <span class="n">gname</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="n">string</span> <span class="n">fname</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
    <span class="kt">float</span> <span class="n">fval</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The definitions are implemented with Protobuf format which is very suitable for data passed across different kinds of
systems with different implemented containers and programming languages. The users can check the data-model-protobuf
library for real definitions.</p>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Algorithm Components</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="user-manual.html">User Manual</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Build Library</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="user-manual.html" title="previous chapter">User Manual</a></li>
      <li>Next: <a href="config.html" title="next chapter">Configurations</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, qfeng.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="_sources/data-model.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>